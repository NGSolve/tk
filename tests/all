# This file contains a top-level script to run all of the Tcl
# tests.  Execute it by invoking "source all" when running tclTest
# in this directory.
#
# RCS: @(#) $Id: all,v 1.1.4.2 1998/09/30 02:18:21 stanton Exp $

# These tests are not done because they cause the new configuration package 
# to crash.

set exclude {}
switch $tcl_platform(platform) {
    "windows" {
	# Tests that cause tk to crash under windows.
	set crash { safe.test }

	# Tests that fail under windows.
	set fail { grid.test }

	set exclude [string tolower [concat $exclude $crash $fail]]
    }
    "macintosh" {
	set x [pwd]
	cd $tk_library
	set tk_library [pwd]
	cd $x
	
	# Tests that cause tk to crash under mac.
	set crash {}

	# Tests that fail under mac.
	set fail {bind.test entry.test send.test textDisp.test}
	
	set exclude [string tolower [concat $exclude $crash $fail]]
    }    
    "unix" {
	# Tests that cause tk to crash under unix.
	set crash {}

	# Tests that fail under unix.
	set fail {}

	set exclude [concat $exclude $crash $fail]
    }
}

if {$tcl_platform(os) == "Win32s"} {
    set tests [lsort [glob *.tes]]
} else {
    set tests [lsort [glob *.test]]
}

foreach i $tests {
    if [string match l.*.test $i] {
	# This is an SCCS lock file;  ignore it.
	continue
    }
    if [lsearch $exclude [string tolower $i]]>=0 {
	# Do not source this file; it exercises a known bug at this time.
	puts stdout "Skipping $i"
	continue
    }
    puts stdout $i
    source $i
}
